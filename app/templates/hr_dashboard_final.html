<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HR ëŒ€ì‹œë³´ë“œ 2025 - OKê¸ˆìœµê·¸ë£¹</title>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans KR', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .header h1 {
            color: #333;
            font-size: 32px;
            margin-bottom: 10px;
        }
        
        .header p {
            color: #666;
            font-size: 16px;
        }
        
        .version-badge {
            display: inline-block;
            background: #52c41a;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            margin-left: 15px;
        }
        
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
        }
        
        .tab {
            background: white;
            padding: 15px 30px;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
            color: #666;
        }
        
        .tab.active {
            background: #6366f1;
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(99, 102, 241, 0.3);
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
            transition: transform 0.3s;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
        }
        
        .stat-card h3 {
            color: #999;
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .stat-number {
            font-size: 48px;
            font-weight: bold;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .stat-label {
            color: #666;
            font-size: 16px;
        }
        
        .content-section {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
            margin-bottom: 20px;
        }
        
        .content-section h2 {
            color: #333;
            margin-bottom: 20px;
            font-size: 24px;
        }
        
        .data-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .data-table th {
            background: #f8f9fa;
            padding: 15px;
            text-align: left;
            font-weight: 600;
            color: #666;
            border-bottom: 2px solid #e9ecef;
        }
        
        .data-table td {
            padding: 15px;
            border-bottom: 1px solid #f1f3f5;
        }
        
        .data-table tr:hover {
            background: #f8f9fa;
        }
        
        .badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .badge-success {
            background: #d4edda;
            color: #155724;
        }
        
        .badge-warning {
            background: #fff3cd;
            color: #856404;
        }
        
        .badge-danger {
            background: #f8d7da;
            color: #721c24;
        }
        
        .badge-info {
            background: #d1ecf1;
            color: #0c5460;
        }
        
        .loading {
            text-align: center;
            padding: 50px;
            color: white;
            font-size: 20px;
        }
        
        .chart-container {
            height: 300px;
            position: relative;
            margin-top: 20px;
        }
        
        .bar-chart {
            display: flex;
            height: 200px;
            align-items: flex-end;
            gap: 20px;
            padding: 20px 0;
        }
        
        .bar {
            flex: 1;
            background: linear-gradient(180deg, #667eea 0%, #764ba2 100%);
            border-radius: 10px 10px 0 0;
            position: relative;
            min-height: 20px;
            transition: all 0.3s;
        }
        
        .bar:hover {
            opacity: 0.8;
            transform: scaleY(1.05);
        }
        
        .bar-label {
            position: absolute;
            bottom: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 14px;
            font-weight: 600;
        }
        
        .bar-value {
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-weight: bold;
            color: #666;
        }
        
        .btn {
            padding: 12px 24px;
            border-radius: 10px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(99, 102, 241, 0.3);
        }
        
        .search-box {
            padding: 12px 20px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            width: 300px;
            font-size: 14px;
            transition: all 0.3s;
        }
        
        .search-box:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>
                HR Intelligence Dashboard
                <span class="version-badge">v2025.01.07</span>
            </h1>
            <p>OKê¸ˆìœµê·¸ë£¹ AI ê¸°ë°˜ ì¸ì¬ ë¶„ì„ ì‹œìŠ¤í…œ</p>
        </div>
        
        <div class="tabs">
            <div class="tab active" onclick="switchTab('dashboard')">ê²½ì˜ì§„ ëŒ€ì‹œë³´ë“œ</div>
            <div class="tab" onclick="switchTab('employees')">ì „ì§ì› ë¶„ì„</div>
            <div class="tab" onclick="switchTab('insights')">AI ì¸ì‚¬ì´íŠ¸</div>
        </div>
        
        <div id="dashboard-content" class="tab-content active">
            <div class="stats-grid">
                <div class="stat-card">
                    <h3>ì´ ì§ì›</h3>
                    <div class="stat-number" id="total-employees">243</div>
                    <div class="stat-label">ëª…</div>
                </div>
                <div class="stat-card">
                    <h3>ìŠ¹ì§„ í›„ë³´ì</h3>
                    <div class="stat-number" id="promotion-candidates">0</div>
                    <div class="stat-label">ëª…</div>
                </div>
                <div class="stat-card">
                    <h3>í•µì‹¬ ì¸ì¬</h3>
                    <div class="stat-number" id="top-talents">10</div>
                    <div class="stat-label">ëª…</div>
                </div>
                <div class="stat-card">
                    <h3>ê´€ë¦¬ í•„ìš”</h3>
                    <div class="stat-number" id="risk-employees">52</div>
                    <div class="stat-label">ëª…</div>
                </div>
            </div>
            
            <div class="content-section">
                <h2>ë“±ê¸‰ ë¶„í¬</h2>
                <div class="bar-chart" id="grade-chart">
                    <div class="bar" style="height: 5%">
                        <span class="bar-value">1ëª…</span>
                        <span class="bar-label">Së“±ê¸‰</span>
                    </div>
                    <div class="bar" style="height: 20%">
                        <span class="bar-value">13ëª…</span>
                        <span class="bar-label">Aë“±ê¸‰</span>
                    </div>
                    <div class="bar" style="height: 80%">
                        <span class="bar-value">117ëª…</span>
                        <span class="bar-label">Bë“±ê¸‰</span>
                    </div>
                    <div class="bar" style="height: 40%">
                        <span class="bar-value">52ëª…</span>
                        <span class="bar-label">Cë“±ê¸‰</span>
                    </div>
                </div>
            </div>
            
            <div class="content-section" id="risk-employees-section">
                <h2>ê´€ë¦¬ í•„ìš” ì¸ë ¥ (52ëª…)</h2>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>ì‚¬ë²ˆ</th>
                            <th>ìœ„í—˜ë„</th>
                            <th>ì ìˆ˜</th>
                            <th>ê´€ë¦¬ ì‚¬ìœ </th>
                        </tr>
                    </thead>
                    <tbody id="risk-employees-table">
                        <!-- ë°ì´í„°ê°€ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì‚½ì…ë©ë‹ˆë‹¤ -->
                    </tbody>
                </table>
            </div>
        </div>
        
        <div id="employees-content" class="tab-content">
            <div class="content-section">
                <div style="margin-bottom: 20px;">
                    <input type="text" class="search-box" placeholder="ì§ì› ê²€ìƒ‰ (ì´ë¦„, ì‚¬ë²ˆ)" id="search-input">
                    <button class="btn btn-primary" style="margin-left: 10px;" onclick="searchEmployees()">ê²€ìƒ‰</button>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>ì‚¬ë²ˆ</th>
                            <th>ì´ë¦„</th>
                            <th>ë¶€ì„œ</th>
                            <th>ì§ê¸‰</th>
                            <th>AI ë“±ê¸‰</th>
                            <th>AI ì ìˆ˜</th>
                            <th>ìƒì„¸</th>
                        </tr>
                    </thead>
                    <tbody id="employees-table">
                        <!-- ì§ì› ë°ì´í„°ê°€ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì‚½ì…ë©ë‹ˆë‹¤ -->
                    </tbody>
                </table>
            </div>
        </div>
        
        <div id="insights-content" class="tab-content">
            <div class="content-section">
                <h2>AI ì¸ì‚¬ì´íŠ¸</h2>
                <div style="padding: 20px; background: #f8f9fa; border-radius: 10px;">
                    <h3 style="color: #667eea; margin-bottom: 15px;">ğŸ“Š ì£¼ìš” ë°œê²¬ì‚¬í•­</h3>
                    <ul style="line-height: 2;">
                        <li>ì „ì²´ ì§ì› ì¤‘ 21.4%ê°€ ê´€ë¦¬ í•„ìš” ì¸ë ¥ìœ¼ë¡œ ë¶„ë¥˜ë¨</li>
                        <li>ìŠ¹ì§„ í›„ë³´ìê°€ í˜„ì¬ 0ëª…ìœ¼ë¡œ, ì¸ì¬ ìœ¡ì„± í”„ë¡œê·¸ë¨ í•„ìš”</li>
                        <li>í•µì‹¬ ì¸ì¬ 10ëª… ì¤‘ ëŒ€ë¶€ë¶„ì´ ê¸°ìˆ ë¶€ì„œì— ì§‘ì¤‘</li>
                        <li>Bë“±ê¸‰ ì§ì›ì´ 48.1%ë¡œ ê°€ì¥ ë§ì€ ë¹„ì¤‘ ì°¨ì§€</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // íƒ­ ì „í™˜ í•¨ìˆ˜
        function switchTab(tabName) {
            // ëª¨ë“  íƒ­ê³¼ ì½˜í…ì¸  ë¹„í™œì„±í™”
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            // ì„ íƒëœ íƒ­ê³¼ ì½˜í…ì¸  í™œì„±í™”
            event.target.classList.add('active');
            document.getElementById(tabName + '-content').classList.add('active');
            
            // ë°ì´í„° ë¡œë“œ
            if (tabName === 'dashboard') {
                loadDashboardData();
            } else if (tabName === 'employees') {
                loadEmployeesData();
            }
        }
        
        // ëŒ€ì‹œë³´ë“œ ë°ì´í„° ë¡œë“œ
        async function loadDashboardData() {
            try {
                const response = await fetch('/api/v1/hr-dashboard/stats');
                if (response.ok) {
                    const data = await response.json();
                    
                    // í†µê³„ ì—…ë°ì´íŠ¸
                    document.getElementById('total-employees').textContent = data.total_employees || 243;
                    document.getElementById('promotion-candidates').textContent = data.promotion_candidates?.count || 0;
                    document.getElementById('top-talents').textContent = data.top_talents?.count || 10;
                    document.getElementById('risk-employees').textContent = data.risk_employees?.count || 52;
                    
                    // ê´€ë¦¬ í•„ìš” ì¸ë ¥ í…Œì´ë¸” ì—…ë°ì´íŠ¸
                    if (data.risk_employees?.employees) {
                        const tbody = document.getElementById('risk-employees-table');
                        tbody.innerHTML = '';
                        
                        data.risk_employees.employees.slice(0, 10).forEach(emp => {
                            const row = tbody.insertRow();
                            row.innerHTML = `
                                <td>${emp.uid || '-'}</td>
                                <td><span class="badge badge-${emp.risk_level === 'high' ? 'danger' : 'warning'}">${emp.risk_level === 'high' ? 'ë†’ìŒ' : 'ë³´í†µ'}</span></td>
                                <td>${emp.risk_score || 0}</td>
                                <td>${emp.reasons?.join(', ') || '-'}</td>
                            `;
                        });
                    }
                }
            } catch (error) {
                console.error('ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);
                // ê¸°ë³¸ ë°ì´í„° í‘œì‹œ
                loadDefaultData();
            }
        }
        
        // ì§ì› ë°ì´í„° ë¡œë“œ
        async function loadEmployeesData() {
            try {
                const response = await fetch('/api/v1/employees');
                if (response.ok) {
                    const data = await response.json();
                    const employees = data.results || [];
                    
                    const tbody = document.getElementById('employees-table');
                    tbody.innerHTML = '';
                    
                    employees.slice(0, 20).forEach(emp => {
                        const row = tbody.insertRow();
                        const gradeColor = emp.grade === 'S' ? 'success' : 
                                          emp.grade === 'A' ? 'info' : 
                                          emp.grade === 'B' ? 'warning' : 'danger';
                        
                        row.innerHTML = `
                            <td>${emp.uid || emp.id?.slice(0, 8) || '-'}</td>
                            <td>${emp.employee_name || 'ìµëª…'}</td>
                            <td>${emp.department || '-'}</td>
                            <td>${emp.position || '-'}</td>
                            <td><span class="badge badge-${gradeColor}">${emp.grade || 'C'}</span></td>
                            <td>${Math.round(emp.overall_score || emp.ai_score || 0)}</td>
                            <td><button class="btn btn-primary" onclick="viewDetail('${emp.id}')">ìƒì„¸ë³´ê¸°</button></td>
                        `;
                    });
                }
            } catch (error) {
                console.error('ì§ì› ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);
            }
        }
        
        // ê¸°ë³¸ ë°ì´í„° ë¡œë“œ
        function loadDefaultData() {
            const tbody = document.getElementById('risk-employees-table');
            tbody.innerHTML = '';
            
            const defaultData = [
                { uid: '8102199', level: 'ë³´í†µ', score: 40, reason: 'ì„±ê³¼ ë¶€ì§„ (59.5ì )' },
                { uid: '5001000', level: 'ë³´í†µ', score: 40, reason: 'ì„±ê³¼ ë¶€ì§„ (56.8ì )' },
                { uid: '3001000', level: 'ë³´í†µ', score: 40, reason: 'ì„±ê³¼ ë¶€ì§„ (56.6ì )' },
                { uid: '8002100', level: 'ë³´í†µ', score: 40, reason: 'ì„±ê³¼ ë¶€ì§„ (57.9ì )' }
            ];
            
            defaultData.forEach(emp => {
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${emp.uid}</td>
                    <td><span class="badge badge-warning">${emp.level}</span></td>
                    <td>${emp.score}</td>
                    <td>${emp.reason}</td>
                `;
            });
        }
        
        // ì§ì› ê²€ìƒ‰
        function searchEmployees() {
            const searchTerm = document.getElementById('search-input').value;
            console.log('ê²€ìƒ‰ì–´:', searchTerm);
            loadEmployeesData(); // ì‹¤ì œë¡œëŠ” í•„í„°ë§ëœ ë°ì´í„° ë¡œë“œ
        }
        
        // ìƒì„¸ë³´ê¸°
        function viewDetail(employeeId) {
            alert('ì§ì› ID ' + employeeId + 'ì˜ ìƒì„¸ ì •ë³´');
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸° ë°ì´í„° ë¡œë“œ
        window.addEventListener('DOMContentLoaded', () => {
            loadDashboardData();
        });
    </script>
</body>
</html>