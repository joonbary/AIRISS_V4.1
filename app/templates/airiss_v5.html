<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIRISS v5.0 - AI HR Intelligence System</title>
    
    <!-- 강력한 캐싱 방지 메타 태그 -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate, max-age=0">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta http-equiv="Clear-Site-Data" content="cache">
    <meta name="refresh-version" content="v5.0.4-revolutionary-fixed">
    
    <!-- Revolutionary Design System 버전 정보 -->
    <meta name="version" content="5.0.0">
    <meta name="build-date" content="2025-08-20">
    <meta name="ui-version" content="revolutionary-design-system-2025-08-20">
    <meta name="design-update" content="glassmorphism-neon-dark-theme">
    <meta name="design-system" content="Revolutionary-Glass-Neon">
    
    <!-- 브라우저 테마 색상 제어 -->
    <meta name="theme-color" content="#00d4ff">
    <meta name="msapplication-TileColor" content="#00d4ff">
    <meta name="msapplication-navbutton-color" content="#00d4ff">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=Noto+Sans+KR:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    
    <!-- Revolutionary Design System CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/airiss_v5.css') }}">
    
    <!-- PDF 생성 라이브러리 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <!-- Chart.js 및 플러그인 (순서 중요) -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
    
    <style>
        /* All styles have been moved to static/css/airiss_v5.css */
    </style>
</head>
<body>
    <!-- Mobile Sidebar Toggle Button -->
    
    <!-- Sidebar Hover Trigger Area -->
    <div class="sidebar-hover-trigger"></div>
    
    <!-- Revolutionary Sidebar Navigation (초기 상태: 축소) -->
    <div class="sidebar collapsed" id="revolutionary-sidebar">
        <div class="sidebar-header">
            <h3>AIRISS v5.0</h3>
        </div>
        <nav class="sidebar-menu">
            <a href="#" class="menu-item active" onclick="AIRISS.switchTab('dashboard')" data-tab="dashboard">
                <span class="menu-icon">📊</span>
                <span class="menu-text">대시보드</span>
            </a>
            <a href="#" class="menu-item" onclick="AIRISS.switchTab('reports')" data-tab="reports">
                <span class="menu-icon">📑</span>
                <span class="menu-text">리포트</span>
            </a>
            <a href="#" class="menu-item" onclick="AIRISS.switchTab('opinion')" data-tab="opinion">
                <span class="menu-icon">💬</span>
                <span class="menu-text">의견 분석</span>
            </a>
            <a href="#" class="menu-item" onclick="AIRISS.switchTab('insights')" data-tab="insights">
                <span class="menu-icon">💡</span>
                <span class="menu-text">AI 인사이트</span>
            </a>
            <a href="#" class="menu-item" onclick="AIRISS.switchTab('employees')" data-tab="employees">
                <span class="menu-icon">👥</span>
                <span class="menu-text">분석 직원 수</span>
            </a>
        </nav>
    </div>
    
    <!-- Main Content Area (초기 상태: 확장) -->
    <div class="main-content expanded">
        <div class="app-container">
        <!-- 헤더 -->
        <header class="app-header">
            <div>
                <h1 class="app-title">OK AIRISS v5.0</h1>
                <p class="app-subtitle">AI-Powered HR Result & Intelligence Scoring System</p>
            </div>
            <div class="version-info">
                <div class="sync-status">
                    <span class="sync-indicator"></span>
                    <span>실시간 동기화</span>
                </div>
                <span class="version-badge">v5.0.0-2025.08.07</span>
            </div>
        </header>
        
        <!-- 기존 탭 네비게이션 제거: 사이드바로 통합 -->
        
        <!-- 대시보드 탭 -->
        <div id="dashboard-tab" class="tab-content active">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">👥</div>
                    <div class="stat-value" id="stat-total">0</div>
                    <div class="stat-label">분석 직원 수</div>
                    <div class="stat-change positive">
                        <span>↑</span>
                        <span>+5% (전월 대비)</span>
                    </div>
                </div>
                
                <div class="stat-card" style="cursor: pointer;" onclick="AIRISS.togglePromotionList()">
                    <div class="stat-icon">🎯</div>
                    <div class="stat-value" id="stat-promotion">0</div>
                    <div class="stat-label">승진 후보자</div>
                    <div class="stat-change positive">
                        <span>↑</span>
                        <span>+2명 증가</span>
                    </div>
                    <div id="promotion-list" style="display: none; margin-top: 15px; padding-top: 15px; border-top: 1px solid #e0e0e0;">
                        <div style="max-height: 200px; overflow-y: auto;">
                            <!-- 승진 후보자 리스트 -->
                        </div>
                    </div>
                </div>
                
                <div class="stat-card" style="cursor: pointer;" onclick="AIRISS.toggleTalentList()">
                    <div class="stat-icon">⭐</div>
                    <div class="stat-value" id="stat-talent">0</div>
                    <div class="stat-label">핵심 인재</div>
                    <div class="stat-change positive">
                        <span>↑</span>
                        <span>+3명 증가</span>
                    </div>
                    <div id="talent-list" style="display: none; margin-top: 15px; padding-top: 15px; border-top: 1px solid #e0e0e0;">
                        <div style="max-height: 200px; overflow-y: auto;">
                            <!-- 핵심 인재 리스트 -->
                        </div>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">⚠️</div>
                    <div class="stat-value" id="stat-risk">0</div>
                    <div class="stat-label">관리 필요</div>
                    <div class="stat-change negative">
                        <span>↓</span>
                        <span>-10% 감소</span>
                    </div>
                </div>
            </div>
            
            <!-- 차트 섹션 추가 -->
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">📊 등급 분포</h2>
                    </div>
                    <div style="padding: 20px;">
                        <canvas id="gradeChart" style="max-height: 300px;"></canvas>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">📈 부서별 성과</h2>
                    </div>
                    <div style="padding: 20px;">
                        <canvas id="departmentChart" style="max-height: 300px;"></canvas>
                    </div>
                </div>
            </div>
            
            <!-- 3개 테이블 그리드 레이아웃 -->
            <div style="display: grid; grid-template-columns: 1fr; gap: 20px;">
                <!-- 승진 후보자 테이블 -->
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">🏆 승진 후보자 명단</h2>
                        <span class="badge" style="background: var(--primary-color); color: white; padding: 8px 16px; border-radius: 8px;">
                            <span id="stat-promotion-table">0</span>명
                        </span>
                    </div>
                    <div class="table-responsive">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>사번</th>
                                    <th>이름</th>
                                    <th>부서</th>
                                    <th>직급</th>
                                    <th>AI 점수</th>
                                    <th>등급</th>
                                    <th>추천 사유</th>
                                    <th>액션</th>
                                </tr>
                            </thead>
                            <tbody id="promotion-candidates-table">
                                <!-- 동적으로 생성됨 -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- 핵심 인재 테이블 -->
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">⭐ 핵심 인재 명단</h2>
                        <span class="badge" style="background: var(--primary-color); color: white; padding: 8px 16px; border-radius: 8px;">
                            <span id="stat-talent-table">0</span>명
                        </span>
                    </div>
                    <div class="table-responsive">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>사번</th>
                                    <th>이름</th>
                                    <th>부서</th>
                                    <th>직급</th>
                                    <th>AI 점수</th>
                                    <th>등급</th>
                                    <th>핵심 역량</th>
                                    <th>액션</th>
                                </tr>
                            </thead>
                            <tbody id="talent-pool-table">
                                <!-- 동적으로 생성됨 -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- 관리 필요 인력 테이블 -->
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">⚠️ 관리 필요 인력 현황</h2>
                        <span class="badge" style="background: #dc3545; color: white; padding: 8px 16px; border-radius: 8px;">
                            <span id="stat-risk-table">0</span>명
                        </span>
                    </div>
                    <div class="table-responsive">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>사번</th>
                                    <th>이름</th>
                                    <th>부서</th>
                                    <th>위험도</th>
                                    <th>점수</th>
                                    <th>관리 사유</th>
                                    <th>액션</th>
                                </tr>
                            </thead>
                            <tbody id="risk-employees-table">
                                <!-- 동적으로 생성됨 -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 분석 직원 목록 탭 -->
        <div id="employees-tab" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">분석 직원 목록</h2>
                    <div style="display: flex; gap: 12px;">
                        <input type="text" id="search-input" placeholder="이름, 사번으로 검색..." 
                               style="padding: 14px 20px; border: 2px solid #E0E0E0; border-radius: 12px; width: 320px; font-size: 16px; transition: all 0.3s; outline: none;" 
                               onfocus="this.style.borderColor='var(--primary-color)'; this.style.boxShadow='0 0 0 3px rgba(0,212,255,0.1)'" 
                               onblur="this.style.borderColor='#E0E0E0'; this.style.boxShadow='none'">
                        <button class="btn btn-primary" onclick="AIRISS.searchEmployees()">
                            🔍 검색
                        </button>
                    </div>
                </div>
                <div class="table-responsive">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>사번</th>
                                <th>이름</th>
                                <th>부서</th>
                                <th>직급</th>
                                <th>AI 등급</th>
                                <th>AI 점수</th>
                                <th>상세보기</th>
                            </tr>
                        </thead>
                        <tbody id="employees-table">
                            <!-- 동적으로 생성됨 -->
                        </tbody>
                    </table>
                    <!-- 페이지네이션 UI -->
                    <div id="pagination-container" style="
                        display: flex;
                        justify-content: center;
                        align-items: center;
                        gap: 10px;
                        margin-top: 30px;
                        padding: 20px;
                    ">
                        <!-- 페이지네이션 버튼이 여기에 동적으로 생성됨 -->
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 데이터 업로드 탭 -->
        <div id="upload-tab" class="tab-content">
            <!-- Step 1: 파일 업로드 -->
            <div class="card" id="upload-step">
                <div class="card-header">
                    <h2 class="card-title">Step 1: 데이터 파일 업로드</h2>
                </div>
                
                <div class="upload-area" id="upload-area" onclick="document.getElementById('file-input').click()">
                    <div class="upload-icon">📁</div>
                    <h3>파일을 드래그하거나 클릭하여 업로드</h3>
                    <p style="color: var(--text-secondary); margin-top: 10px;">
                        지원 형식: Excel (.xlsx, .xls), CSV (.csv)
                    </p>
                    <input type="file" id="file-input" accept=".xlsx,.xls,.csv" style="display: none;" onchange="AIRISS.handleFileSelect(event)">
                </div>
                
                <div id="upload-progress" style="display: none;">
                    <h3 style="margin: 20px 0 10px;">업로드 진행 상황</h3>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-fill" style="width: 0%"></div>
                    </div>
                    <p id="progress-text" style="text-align: center; color: var(--text-secondary);">준비 중...</p>
                </div>
                
                <div id="file-analysis-result" style="display: none; margin-top: 20px;">
                    <!-- 파일 분석 결과가 여기 표시됩니다 -->
                </div>
            </div>

            <!-- Step 2: 분석 설정 -->
            <div class="card" id="analysis-config-step" style="display: none;">
                <div class="card-header">
                    <h2 class="card-title">Step 2: AI 분석 설정</h2>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 20px;">
                    <div>
                        <h3>분석 모드</h3>
                        <div style="margin: 15px 0;">
                            <label style="display: flex; align-items: center; margin-bottom: 10px;">
                                <input type="radio" name="analysis-mode" value="hybrid" checked style="margin-right: 8px;">
                                <span><strong>하이브리드</strong> - 정량+정성 통합 분석 (추천)</span>
                            </label>
                            <label style="display: flex; align-items: center; margin-bottom: 10px;">
                                <input type="radio" name="analysis-mode" value="text_only" style="margin-right: 8px;">
                                <span><strong>텍스트만</strong> - 의견/피드백 위주 분석</span>
                            </label>
                            <label style="display: flex; align-items: center;">
                                <input type="radio" name="analysis-mode" value="quantitative" style="margin-right: 8px;">
                                <span><strong>정량만</strong> - 수치 데이터 위주 분석</span>
                            </label>
                        </div>
                    </div>
                    
                    <div>
                        <h3>AI 모델 설정</h3>
                        <div style="margin: 15px 0;">
                            <label style="display: block; margin-bottom: 10px;">
                                <span>AI 모델:</span>
                                <select id="openai-model" style="width: 100%; padding: 8px; margin-top: 5px; border: 1px solid var(--border-color); border-radius: 6px;">
                                    <option value="gpt-3.5-turbo">GPT-3.5 Turbo (빠름, 경제적)</option>
                                    <option value="gpt-4">GPT-4 (정확함, 고품질)</option>
                                    <option value="gpt-4-turbo">GPT-4 Turbo (균형)</option>
                                </select>
                            </label>
                            <label style="display: block; margin-bottom: 10px;">
                                <span>최대 토큰:</span>
                                <select id="max-tokens" style="width: 100%; padding: 8px; margin-top: 5px; border: 1px solid var(--border-color); border-radius: 6px;">
                                    <option value="1200">1,200 토큰 (빠름)</option>
                                    <option value="2000">2,000 토큰 (표준)</option>
                                    <option value="3000">3,000 토큰 (상세)</option>
                                </select>
                            </label>
                        </div>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 20px;">
                    <div>
                        <h3>분석 대상</h3>
                        <div style="margin: 15px 0;">
                            <label style="display: block; margin-bottom: 10px;">
                                <span>분석할 인원 수:</span>
                                <select id="sample-size" style="width: 100%; padding: 8px; margin-top: 5px; border: 1px solid var(--border-color); border-radius: 6px;">
                                    <option value="5">5명 (테스트용)</option>
                                    <option value="10" selected>10명 (기본)</option>
                                    <option value="20">20명 (표준)</option>
                                    <option value="50">50명 (대용량)</option>
                                    <option value="100">100명 (전체)</option>
                                    <option value="-1">전체 인원</option>
                                </select>
                            </label>
                        </div>
                    </div>
                    
                    <div>
                        <h3>고급 옵션</h3>
                        <div style="margin: 15px 0;">
                            <label style="display: flex; align-items: center; margin-bottom: 15px;">
                                <input type="checkbox" id="enable-ai-feedback" checked style="margin-right: 8px;">
                                <span>AI 피드백 생성 (강점/개선점 분석)</span>
                            </label>
                            <label style="display: flex; align-items: center;">
                                <input type="checkbox" id="enable-realtime" checked style="margin-right: 8px;">
                                <span>실시간 진행 상황 표시</span>
                            </label>
                        </div>
                    </div>
                </div>
                
                <div style="text-align: center; margin-top: 30px;">
                    <button class="btn btn-primary" style="font-size: 16px; padding: 15px 40px;" onclick="AIRISS.startAnalysisWithConfig()">
                        🚀 AI 분석 시작
                    </button>
                </div>
            </div>

            <!-- Step 3: 분석 진행 -->
            <div class="card" id="analysis-progress-step" style="display: none;">
                <div class="card-header">
                    <h2 class="card-title">Step 3: AI 분석 진행 중</h2>
                </div>
                
                <div id="analysis-progress-detail">
                    <div style="text-align: center; margin: 30px 0;">
                        <div class="spinner"></div>
                        <h3 style="margin: 20px 0;">AI가 데이터를 분석하고 있습니다...</h3>
                    </div>
                    
                    <div class="progress-bar" style="height: 20px; margin: 20px 0;">
                        <div class="progress-fill" id="analysis-progress-fill" style="width: 0%; transition: width 0.5s;"></div>
                    </div>
                    
                    <div id="analysis-status-text" style="text-align: center; color: var(--text-secondary); margin: 15px 0;">
                        분석 준비 중...
                    </div>
                    
                    <div id="analysis-log" style="background: var(--bg-secondary); padding: 20px; border-radius: 12px; max-height: 300px; overflow-y: auto; font-family: monospace; font-size: 14px;">
                        <div>🔄 분석 작업이 시작되었습니다...</div>
                    </div>
                </div>
                
                <div id="analysis-complete-section" style="display: none;">
                    <div style="text-align: center; color: var(--success); margin: 30px 0;">
                        <h2>✅ AI 분석 완료!</h2>
                        <p style="margin-top: 10px;">분석 결과를 확인하시려면 아래 버튼을 클릭하세요.</p>
                    </div>
                    
                    <div style="text-align: center; margin-top: 30px;">
                        <button class="btn btn-success" style="font-size: 16px; padding: 15px 40px; margin-right: 15px;" onclick="AIRISS.viewAnalysisResults()">
                            📊 분석 결과 보기
                        </button>
                        <button class="btn btn-primary" style="font-size: 16px; padding: 15px 40px;" onclick="AIRISS.downloadAnalysisReport()">
                            📄 리포트 다운로드
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- AI 인사이트 탭 -->
        <div id="insights-tab" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">AI 기반 인사이트</h2>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-primary" onclick="AIRISS.generateRealTimeInsights()" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border: none;">
                            <i class="fas fa-brain"></i> AI 인사이트 생성
                        </button>
                        <button class="btn btn-success" onclick="AIRISS.refreshInsights()">
                            🔄 새로고침
                        </button>
                    </div>
                </div>
                <div id="insights-generation-status" style="display: none; padding: 15px; background: rgba(102, 126, 234, 0.1); border-left: 4px solid #667eea; margin: 15px 20px; border-radius: 4px;">
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <div class="spinner" style="width: 20px; height: 20px;"></div>
                        <span style="color: var(--text-secondary);">AI가 실시간 데이터를 분석하여 인사이트를 생성하고 있습니다...</span>
                    </div>
                </div>
                <div id="insights-content">
                    <!-- 동적으로 생성됨 -->
                </div>
            </div>
        </div>
        
        <!-- 의견 분석 탭 -->
        <div id="opinion-tab" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">의견 분석</h2>
                    <p style="color: #6c757d; font-size: 14px; margin-top: 8px;">
                        특정 직원의 평가의견을 AI로 분석하여 강점, 개선점, 핵심역량을 도출합니다.
                    </p>
                </div>
                
                <!-- 직원 선택 섹션 -->
                <div style="margin-bottom: 25px; padding: 20px; background: #f8f9fa; border-radius: 12px; border: 1px solid #e9ecef;">
                    <h3 style="margin: 0 0 15px 0; font-size: 16px; color: #2c3e50;">📋 분석 대상 직원 선택</h3>
                    
                    <div style="display: grid; grid-template-columns: 1fr auto; gap: 15px; align-items: end;">
                        <!-- 직원 검색 및 선택 -->
                        <div>
                            <label for="employee-search" style="display: block; margin-bottom: 8px; font-weight: 500; color: #2c3e50;">
                                직원 검색 (이름 또는 UID)
                            </label>
                            <div style="position: relative;">
                                <input 
                                    type="text" 
                                    id="employee-search" 
                                    placeholder="직원 이름을 입력하세요 (예: 김철수, 4106020)" 
                                    style="width: 100%; padding: 12px 40px 12px 15px; border: 1px solid #e9ecef; border-radius: 8px; font-size: 14px;"
                                    oninput="AIRISS.searchEmployeesForOpinion(this.value)"
                                    autocomplete="off"
                                />
                                <div style="position: absolute; right: 12px; top: 50%; transform: translateY(-50%); color: #6c757d;">
                                    🔍
                                </div>
                            </div>
                            
                            <!-- 검색 결과 드롭다운 -->
                            <div id="employee-dropdown" style="
                                position: absolute; 
                                z-index: 1000; 
                                width: calc(100% - 30px); 
                                max-height: 200px; 
                                overflow-y: auto; 
                                background: white; 
                                border: 1px solid #e9ecef; 
                                border-radius: 8px; 
                                box-shadow: 0 4px 12px rgba(0,0,0,0.15); 
                                display: none; 
                                margin-top: 5px;
                            ">
                                <!-- 동적으로 생성됨 -->
                            </div>
                        </div>
                        
                        <!-- 선택된 직원 정보 -->
                        <div style="text-align: center; min-width: 120px;">
                            <div id="selected-employee" style="
                                padding: 12px; 
                                background: white; 
                                border: 2px solid #e9ecef; 
                                border-radius: 8px; 
                                font-size: 13px;
                                color: #6c757d;
                            ">
                                직원을 선택해주세요
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 의견 입력 섹션 -->
                <div style="margin-bottom: 20px;">
                    <label for="opinion-text" style="display: block; margin-bottom: 8px; font-weight: 500; color: #2c3e50;">
                        평가 의견 입력
                    </label>
                    <textarea 
                        id="opinion-text" 
                        placeholder="선택한 직원에 대한 평가의견을 입력하세요... (예: 업무 태도, 성과, 협업능력, 성장 가능성 등)" 
                        style="width: 100%; height: 180px; padding: 15px; border: 1px solid #e9ecef; 
                               border-radius: 12px; resize: vertical; font-size: 14px; line-height: 1.5;"></textarea>
                    <div style="font-size: 12px; color: #6c757d; margin-top: 5px;">
                        💡 구체적이고 상세한 의견일수록 더 정확한 AI 분석 결과를 얻을 수 있습니다. (최소 10자 이상)
                    </div>
                </div>
                
                <!-- AI 분석 온도 조절 섹션 -->
                <div style="margin-bottom: 25px; padding: 20px; background: #f8f9fa; border-radius: 12px; border: 1px solid #e9ecef;">
                    <h3 style="margin: 0 0 15px 0; font-size: 16px; color: #2c3e50;">🌡️ AI 분석 관점 설정</h3>
                    <p style="margin: 0 0 15px 0; font-size: 13px; color: #6c757d;">
                        평가의견을 분석할 때 AI의 관점을 조절합니다. 칭찬 중심부터 개선 중심까지 선택할 수 있습니다.
                    </p>
                    
                    <div style="position: relative; padding: 10px 0;">
                        <!-- 슬라이더 -->
                        <input type="range" 
                               id="temperature-slider" 
                               min="1" 
                               max="5" 
                               value="3" 
                               step="1"
                               style="width: 100%; height: 6px; background: linear-gradient(to right, #28a745 0%, #ffc107 50%, #dc3545 100%); border-radius: 3px; outline: none; -webkit-appearance: none;"
                               oninput="AIRISS.updateTemperatureDisplay(this.value)">
                        
                        <!-- 레이블 표시 -->
                        <div style="display: flex; justify-content: space-between; margin-top: 10px; font-size: 12px;">
                            <span style="color: #28a745; font-weight: 600;">매우 긍정적</span>
                            <span style="color: #17a2b8;">긍정적</span>
                            <span style="color: #6c757d; font-weight: 600;">중립적</span>
                            <span style="color: #fd7e14;">부정적</span>
                            <span style="color: #dc3545; font-weight: 600;">매우 부정적</span>
                        </div>
                        
                        <!-- 현재 선택값 표시 -->
                        <div id="temperature-display" style="
                            margin-top: 15px; 
                            padding: 12px; 
                            background: white; 
                            border: 2px solid #6c757d; 
                            border-radius: 8px; 
                            text-align: center;
                        ">
                            <div style="font-size: 14px; color: #2c3e50; font-weight: 600;">현재 설정: <span id="temp-value" style="color: #6c757d;">중립적 분석</span></div>
                            <div style="font-size: 12px; color: #6c757d; margin-top: 5px;" id="temp-description">
                                균형 잡힌 시각으로 장단점을 공정하게 분석합니다
                            </div>
                        </div>
                    </div>
                </div>
                
                <div style="margin-top: 20px;">
                    <button class="btn btn-primary" onclick="AIRISS.analyzeOpinion()" id="analyze-opinion-btn">
                        🤖 AI 분석 시작
                    </button>
                </div>
                <div id="opinion-results" style="margin-top: 30px;">
                    <!-- 분석 결과가 여기에 표시됨 -->
                </div>
            </div>
        </div>
        
        <!-- 리포트 탭 -->
        <div id="reports-tab" class="tab-content">
            <div class="card" style="background: linear-gradient(135deg, rgba(10, 15, 27, 0.95) 0%, rgba(26, 31, 46, 0.9) 100%); border: 1px solid rgba(0, 212, 255, 0.2);">
                <div class="card-header" style="background: rgba(0, 212, 255, 0.1); border-bottom: 2px solid rgba(0, 212, 255, 0.3);">
                    <h2 class="card-title" style="color: #00d4ff; text-shadow: 0 0 20px rgba(0, 212, 255, 0.5);">
                        📊 AI 분석 리포트
                    </h2>
                    <p style="color: rgba(255, 255, 255, 0.8); font-size: 14px; margin-top: 8px;">
                        AI 기반 심층 분석 리포트 - 데이터 기반 의사결정을 위한 인사이트
                    </p>
                </div>
                
                <!-- 리포트 타입 선택 버튼 -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; padding: 30px; background: rgba(255, 255, 255, 0.03); border-radius: 20px; margin: 20px;">
                    <button class="report-btn" style="
                        padding: 20px;
                        background: linear-gradient(135deg, rgba(0, 212, 255, 0.1) 0%, rgba(0, 153, 255, 0.1) 100%);
                        border: 1px solid rgba(0, 212, 255, 0.3);
                        border-radius: 15px;
                        color: #ffffff;
                        font-size: 14px;
                        font-weight: 600;
                        cursor: pointer;
                        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
                        box-shadow: 0 4px 15px rgba(0, 212, 255, 0.1);
                    " 
                    onmouseover="this.style.transform='translateY(-5px)'; this.style.boxShadow='0 8px 25px rgba(0, 212, 255, 0.3)'; this.style.background='linear-gradient(135deg, rgba(0, 212, 255, 0.2) 0%, rgba(0, 153, 255, 0.2) 100%)'"
                    onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(0, 212, 255, 0.1)'; this.style.background='linear-gradient(135deg, rgba(0, 212, 255, 0.1) 0%, rgba(0, 153, 255, 0.1) 100%)'"
                    onclick="AIRISS.showReport('monthly')">
                        <div style="font-size: 24px; margin-bottom: 8px;">📊</div>
                        <div>월간 종합</div>
                        <div style="font-size: 12px; color: rgba(255, 255, 255, 0.6); margin-top: 4px;">전체 현황 분석</div>
                    </button>
                    
                    <button class="report-btn" style="
                        padding: 20px;
                        background: linear-gradient(135deg, rgba(123, 97, 255, 0.1) 0%, rgba(102, 126, 234, 0.1) 100%);
                        border: 1px solid rgba(123, 97, 255, 0.3);
                        border-radius: 15px;
                        color: #ffffff;
                        font-size: 14px;
                        font-weight: 600;
                        cursor: pointer;
                        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
                        box-shadow: 0 4px 15px rgba(123, 97, 255, 0.1);
                    "
                    onmouseover="this.style.transform='translateY(-5px)'; this.style.boxShadow='0 8px 25px rgba(123, 97, 255, 0.3)'; this.style.background='linear-gradient(135deg, rgba(123, 97, 255, 0.2) 0%, rgba(102, 126, 234, 0.2) 100%)'"
                    onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(123, 97, 255, 0.1)'; this.style.background='linear-gradient(135deg, rgba(123, 97, 255, 0.1) 0%, rgba(102, 126, 234, 0.1) 100%)'"
                    onclick="AIRISS.showReport('talent')">
                        <div style="font-size: 24px; margin-bottom: 8px;">⭐</div>
                        <div>핵심 인재</div>
                        <div style="font-size: 12px; color: rgba(255, 255, 255, 0.6); margin-top: 4px;">상위 성과자 분석</div>
                    </button>
                    
                    <button class="report-btn" style="
                        padding: 20px;
                        background: linear-gradient(135deg, rgba(255, 152, 0, 0.1) 0%, rgba(255, 193, 7, 0.1) 100%);
                        border: 1px solid rgba(255, 152, 0, 0.3);
                        border-radius: 15px;
                        color: #ffffff;
                        font-size: 14px;
                        font-weight: 600;
                        cursor: pointer;
                        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
                        box-shadow: 0 4px 15px rgba(255, 152, 0, 0.1);
                    "
                    onmouseover="this.style.transform='translateY(-5px)'; this.style.boxShadow='0 8px 25px rgba(255, 152, 0, 0.3)'; this.style.background='linear-gradient(135deg, rgba(255, 152, 0, 0.2) 0%, rgba(255, 193, 7, 0.2) 100%)'"
                    onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(255, 152, 0, 0.1)'; this.style.background='linear-gradient(135deg, rgba(255, 152, 0, 0.1) 0%, rgba(255, 193, 7, 0.1) 100%)'"
                    onclick="AIRISS.showReport('risk')">
                        <div style="font-size: 24px; margin-bottom: 8px;">⚠️</div>
                        <div>리스크 관리</div>
                        <div style="font-size: 12px; color: rgba(255, 255, 255, 0.6); margin-top: 4px;">위험 요소 분석</div>
                    </button>
                    
                    <button class="report-btn" style="
                        padding: 20px;
                        background: linear-gradient(135deg, rgba(76, 175, 80, 0.1) 0%, rgba(139, 195, 74, 0.1) 100%);
                        border: 1px solid rgba(76, 175, 80, 0.3);
                        border-radius: 15px;
                        color: #ffffff;
                        font-size: 14px;
                        font-weight: 600;
                        cursor: pointer;
                        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
                        box-shadow: 0 4px 15px rgba(76, 175, 80, 0.1);
                    "
                    onmouseover="this.style.transform='translateY(-5px)'; this.style.boxShadow='0 8px 25px rgba(76, 175, 80, 0.3)'; this.style.background='linear-gradient(135deg, rgba(76, 175, 80, 0.2) 0%, rgba(139, 195, 74, 0.2) 100%)'"
                    onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(76, 175, 80, 0.1)'; this.style.background='linear-gradient(135deg, rgba(76, 175, 80, 0.1) 0%, rgba(139, 195, 74, 0.1) 100%)'"
                    onclick="AIRISS.showReport('performance')">
                        <div style="font-size: 24px; margin-bottom: 8px;">📈</div>
                        <div>성과 분석</div>
                        <div style="font-size: 12px; color: rgba(255, 255, 255, 0.6); margin-top: 4px;">성과 트렌드 분석</div>
                    </button>
                    
                    <button class="report-btn" style="
                        padding: 20px;
                        background: linear-gradient(135deg, rgba(233, 30, 99, 0.1) 0%, rgba(244, 67, 54, 0.1) 100%);
                        border: 1px solid rgba(233, 30, 99, 0.3);
                        border-radius: 15px;
                        color: #ffffff;
                        font-size: 14px;
                        font-weight: 600;
                        cursor: pointer;
                        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
                        box-shadow: 0 4px 15px rgba(233, 30, 99, 0.1);
                    "
                    onmouseover="this.style.transform='translateY(-5px)'; this.style.boxShadow='0 8px 25px rgba(233, 30, 99, 0.3)'; this.style.background='linear-gradient(135deg, rgba(233, 30, 99, 0.2) 0%, rgba(244, 67, 54, 0.2) 100%)'"
                    onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(233, 30, 99, 0.1)'; this.style.background='linear-gradient(135deg, rgba(233, 30, 99, 0.1) 0%, rgba(244, 67, 54, 0.1) 100%)'"
                    onclick="AIRISS.showReport('department')">
                        <div style="font-size: 24px; margin-bottom: 8px;">🏢</div>
                        <div>부서별 분석</div>
                        <div style="font-size: 12px; color: rgba(255, 255, 255, 0.6); margin-top: 4px;">조직별 성과 비교</div>
                    </button>
                    
                    <button class="report-btn" style="
                        padding: 20px;
                        background: linear-gradient(135deg, rgba(156, 39, 176, 0.1) 0%, rgba(103, 58, 183, 0.1) 100%);
                        border: 1px solid rgba(156, 39, 176, 0.3);
                        border-radius: 15px;
                        color: #ffffff;
                        font-size: 14px;
                        font-weight: 600;
                        cursor: pointer;
                        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
                        box-shadow: 0 4px 15px rgba(156, 39, 176, 0.1);
                    "
                    onmouseover="this.style.transform='translateY(-5px)'; this.style.boxShadow='0 8px 25px rgba(156, 39, 176, 0.3)'; this.style.background='linear-gradient(135deg, rgba(156, 39, 176, 0.2) 0%, rgba(103, 58, 183, 0.2) 100%)'"
                    onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(156, 39, 176, 0.1)'; this.style.background='linear-gradient(135deg, rgba(156, 39, 176, 0.1) 0%, rgba(103, 58, 183, 0.1) 100%)'"
                    onclick="AIRISS.showReport('executive')">
                        <div style="font-size: 24px; margin-bottom: 8px;">💼</div>
                        <div>경영진 브리핑</div>
                        <div style="font-size: 12px; color: rgba(255, 255, 255, 0.6); margin-top: 4px;">Executive Summary</div>
                    </button>
                </div>
                
                <!-- 리포트 내용 표시 영역 -->
                <div id="report-content" style="min-height: 600px; padding: 30px; background: linear-gradient(135deg, rgba(52, 61, 84, 0.95) 0%, rgba(41, 49, 69, 0.9) 100%); border: 1px solid rgba(88, 95, 112, 0.4); border-radius: 12px; overflow-y: auto; max-height: 80vh;">
                    <div style="text-align: center; padding: 100px 20px; color: #6c757d;">
                        <i style="font-size: 64px; margin-bottom: 20px; display: block; opacity: 0.5;">📄</i>
                        <h3 style="color: #495057;">리포트를 선택해주세요</h3>
                        <p>위의 버튼을 클릭하여 원하는 리포트를 생성하고 확인하세요.</p>
                        <p style="font-size: 12px; margin-top: 20px;">생성된 리포트는 인쇄하거나 다운로드할 수 있습니다.</p>
                    </div>
                </div>
                
                <!-- 리포트 액션 버튼 -->
                <div id="report-actions" style="display: none; margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px; text-align: right;">
                    <span style="float: left; color: #6c757d; line-height: 36px;">
                        <i id="report-type-icon">📄</i> <span id="report-type-name">리포트</span>
                    </span>
                    <button class="btn btn-secondary" onclick="AIRISS.printReport()" style="margin-right: 10px;">
                        🖨️ 인쇄
                    </button>
                    <button class="btn btn-secondary" onclick="AIRISS.copyReport()" style="margin-right: 10px;">
                        📋 복사
                    </button>
                    <button class="btn btn-primary" onclick="AIRISS.downloadReportAsHTML()">
                        💾 HTML 저장
                    </button>
                    <button class="btn btn-primary" onclick="AIRISS.downloadReportAsPDF()" style="margin-left: 10px;">
                        📄 PDF 저장
                    </button>
                </div>
            </div>
        </div>
        
        <!-- 직원 상세 모달 -->
        <div id="employee-modal" class="modal">
            <div class="modal-content">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; color: var(--text-primary);">
                    <h2 id="modal-title" style="color: var(--text-primary);">직원 상세 정보</h2>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-primary" onclick="AIRISS.downloadPDF()" style="padding: 10px 20px; font-size: 14px; border-radius: 8px;">
                            📄 PDF 다운로드
                        </button>
                        <button class="btn btn-secondary" onclick="AIRISS.closeModal()" style="padding: 10px 20px; font-size: 14px; border-radius: 8px;">
                            ✖ 닫기
                        </button>
                    </div>
                </div>
                <div id="modal-body" style="color: var(--text-primary);">
                    <!-- 동적으로 생성됨 -->
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // JavaScript code moved to static/js/airiss_v5.js
    </script>
    
    <script>
        // Main application code moved to static/js/airiss_v5.js
    </script>
    
    <!-- Include AIRISS Configuration -->
    <script src="{{ url_for('static', filename='js/config.js') }}"></script>
    <!-- Include AIRISS Main JavaScript -->
    <script src="{{ url_for('static', filename='js/airiss_v5.js') }}"></script>
        </div>
    </div>
</body>
</html>